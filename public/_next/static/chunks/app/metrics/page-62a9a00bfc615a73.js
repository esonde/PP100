(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[860],{3042:function(e,t,s){Promise.resolve().then(s.bind(s,8566))},8566:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return r}});var n=s(7437),a=s(2265),i=s(6907);function r(){let[e,t]=(0,a.useState)(null),[s,r]=(0,a.useState)(null),[l,o]=(0,a.useState)(null),[d,c]=(0,a.useState)(null),[x,m]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/data/manifest.json?ts=".concat(Date.now()));if(!e.ok)throw Error("Failed to fetch manifest: ".concat(e.status));let s=await e.json();t(s);let n=await (0,i.gs)(s);r(n);let a=await (0,i.jy)();if(o(a),s.generated_at){let e=(0,i.f6)(s.generated_at);c(e)}m(!1)}catch(e){h(e instanceof Error?e.message:"Unknown error"),m(!1)}})()},[]);let g=t=>{var s;let a=null==e?void 0:null===(s=e.sources)||void 0===s?void 0:s[t],i="error"===a,r="no_data"===a,l="Sconosciuto",o="text-gray-500",d="❓";return i?(l="Errore",o="text-red-600",d="❌"):r?(l="Nessun dato",o="text-yellow-600",d="⚠️"):a&&"unknown"!==a&&(l="Attivo",o="text-green-600",d="✅"),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-green-500",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"camera"===t?"Camera dei Deputati":"Senato della Repubblica"}),(0,n.jsx)("p",{className:"text-2xl font-bold ".concat(o),children:l}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"camera"===t?"Assemblea":"Aula"})]}),(0,n.jsx)("div",{className:"text-4xl",children:d})]}),a&&"unknown"!==a&&"error"!==a&&"no_data"!==a&&(0,n.jsx)("div",{className:"mt-4 text-xs text-gray-500 break-all",children:(0,n.jsx)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:a})})]})};return x?(0,n.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-8",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"Caricamento metriche..."})]})}):u?(0,n.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-8",children:(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"text-red-600 text-xl mr-3",children:"❌"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-red-900",children:"Errore nel caricamento"}),(0,n.jsx)("p",{className:"text-red-800 mt-1",children:u})]})]})})}):(0,n.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-8",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Metriche Sistema"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Monitoraggio in tempo reale della pipeline di ingest e dello stato del registry"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(()=>{if(!s)return null;let e="Caricamento...",t="text-gray-500",a="\uD83D\uDCCA";return -1===s.count?(e="File disponibile (Parquet)",t="text-green-600",a="\uD83D\uDCCA"):0===s.count?(e="Nessun intervento",t="text-yellow-600",a="⚠️"):(e="".concat(s.count," interventi"),t="text-green-600",a="✅"),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Interventi Oggi"}),(0,n.jsx)("p",{className:"text-2xl font-bold ".concat(t),children:e}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["File: ",s.downloadUrl?(0,n.jsx)("a",{href:s.downloadUrl,download:s.filename,className:"text-blue-600 hover:text-blue-800 underline hover:no-underline",title:"Scarica ".concat(s.filename),children:s.filename}):s.filename]}),(0,n.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Ultimo aggiornamento: ",s.lastUpdate]})]}),(0,n.jsx)("div",{className:"text-4xl",children:a})]}),"parquet"===s.source&&(0,n.jsx)("div",{className:"mt-3 p-2 bg-blue-50 rounded text-xs text-blue-700",children:"\uD83D\uDCA1 File Parquet: i dati sono disponibili ma non visualizzabili nel browser"})]})})(),g("camera"),g("senato"),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-indigo-500",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Registry Identit\xe0"}),l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{className:"text-2xl font-bold text-indigo-600",children:[l.personsCount," persone"]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[l.partiesCount," partiti • ",l.inboxCount," in inbox"]}),(0,n.jsx)("div",{className:"mt-3 space-y-1",children:(0,n.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,n.jsx)("a",{href:l.downloadUrls.persons,download:"persons.jsonl",className:"text-blue-600 hover:text-blue-800 underline hover:no-underline mr-3",title:"Scarica persone",children:"\uD83D\uDCE5 persons.jsonl"}),(0,n.jsx)("a",{href:l.downloadUrls.parties,download:"party_registry.jsonl",className:"text-blue-600 hover:text-blue-800 underline hover:no-underline mr-3",title:"Scarica partiti",children:"\uD83D\uDCE5 party_registry.jsonl"}),(0,n.jsx)("a",{href:l.downloadUrls.inbox,download:"identities_inbox.jsonl",className:"text-blue-600 hover:text-blue-800 underline hover:no-underline",title:"Scarica inbox",children:"\uD83D\uDCE5 identities_inbox.jsonl"})]})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-2xl font-bold text-gray-400",children:"Caricamento..."}),(0,n.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Contando persone e partiti..."})]})]}),(0,n.jsx)("div",{className:"text-4xl",children:"\uD83D\uDC65"})]}),!l&&(0,n.jsx)("div",{className:"mt-4 text-xs text-gray-500",children:"Il registry viene aggiornato automaticamente ogni 5 minuti"})]}),(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-purple-500",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Versione Schema"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:(null==e?void 0:e.version)||"N/A"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Schema dati"})]}),(0,n.jsx)("div",{className:"text-4xl",children:"\uD83D\uDCCB"})]})}),(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-orange-500",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Ultimo Aggiornamento"}),(0,n.jsx)("p",{className:"text-lg font-bold text-orange-600",children:(null==e?void 0:e.generated_at)?new Date(e.generated_at).toLocaleString("it-IT"):"N/A"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Timestamp UTC"})]}),(0,n.jsx)("div",{className:"text-4xl",children:"\uD83D\uDD52"})]})})]}),(0,n.jsxs)("div",{className:"mt-8 bg-gray-50 rounded-lg p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informazioni Sistema"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium text-gray-700",children:"Architettura:"}),(0,n.jsx)("span",{className:"ml-2 text-gray-600",children:"GitHub-only (Pages + Actions)"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium text-gray-700",children:"Pipeline:"}),(0,n.jsx)("span",{className:"ml-2 text-gray-600",children:"Ingest ogni 5 minuti"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium text-gray-700",children:"Formato Dati:"}),(0,n.jsx)("span",{className:"ml-2 text-gray-600",children:"Parquet + JSON"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium text-gray-700",children:"Validazione:"}),(0,n.jsx)("span",{className:"ml-2 text-gray-600",children:"Schema JSON + CI/CD"})]})]})]}),(0,n.jsx)("div",{className:"mt-8 bg-blue-50 rounded-lg p-6 border-l-4 border-blue-400",children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("div",{className:"text-blue-600 text-xl mr-3",children:"ℹ️"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Dati Dinamici"}),(0,n.jsxs)("p",{className:"text-blue-800 text-sm",children:["Questa pagina mostra dati in tempo reale dalla pipeline di ingest. I file vengono aggiornati automaticamente ogni 5 minuti tramite GitHub Actions. Per i dettagli completi degli interventi, consulta i file Parquet in ",(0,n.jsx)("code",{className:"bg-blue-100 px-1 rounded",children:"public/data/"}),"."]}),(0,n.jsxs)("p",{className:"text-blue-800 text-sm mt-2",children:[(0,n.jsx)("strong",{children:"Prossimo aggiornamento:"})," ",d?"".concat(d.nextUpdate," (tra ").concat(d.timeUntil,")"):"Calcolo in corso..."]})]})]})})]})}},6907:function(e,t,s){"use strict";function n(e){let t=new Date,s=5*Math.ceil(t.getMinutes()/5),n=new Date(t);n.setMinutes(s,0,0),n<=t&&n.setMinutes(n.getMinutes()+5);let a=n.getTime()-t.getTime();return{nextUpdate:n.toLocaleString("it-IT"),timeUntil:"".concat(Math.ceil(a/6e4)," minuti")}}function a(e){try{return new Date(e).toLocaleString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(e){return"Data non valida"}}async function i(e){try{let t=await fetch(e);if(!t.ok)return 0;return(await t.text()).trim().split("\n").filter(e=>e.trim()).length}catch(e){return 0}}async function r(e){try{let t=await fetch(e);if(!t.ok)return[];return(await t.text()).trim().split("\n").filter(e=>e.trim()).map(e=>JSON.parse(e))}catch(e){return[]}}async function l(){try{let[e,t,s]=await Promise.all([r("/data/persons.jsonl"),r("/data/party_registry.jsonl"),r("/data/identities_inbox.jsonl")]);return{personsCount:e.length,partiesCount:t.length,inboxCount:s.length,persons:e,parties:t,downloadUrls:{persons:"/data/persons.jsonl",parties:"/data/party_registry.jsonl",inbox:"/data/identities_inbox.jsonl"}}}catch(e){return{personsCount:0,partiesCount:0,inboxCount:0,persons:[],parties:[],downloadUrls:{persons:"/data/persons.jsonl",parties:"/data/party_registry.jsonl",inbox:"/data/identities_inbox.jsonl"}}}}async function o(e){var t;if(!(null===(t=e.current)||void 0===t?void 0:t.interventions))return{count:0,filename:"N/A",lastUpdate:"N/A",source:"none",downloadUrl:""};let s=e.current.interventions.split("/").pop()||"N/A",n=e.generated_at,r="/data/".concat(s);if(s.endsWith(".parquet"))return{count:-1,filename:s,lastUpdate:a(n),source:"parquet",downloadUrl:r};if(s.endsWith(".json")||s.endsWith(".jsonl"))try{return{count:await i("/data/".concat(s)),filename:s,lastUpdate:a(n),source:"json",downloadUrl:r}}catch(e){return{count:0,filename:s,lastUpdate:a(n),source:"json",downloadUrl:r}}return{count:0,filename:s,lastUpdate:a(n),source:"none",downloadUrl:""}}s.d(t,{f6:function(){return n},gs:function(){return o},jy:function(){return l}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=3042)}),_N_E=e.O()}]);