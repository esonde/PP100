(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[860],{3042:function(e,t,a){Promise.resolve().then(a.bind(a,8566))},8566:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var n=a(7437),s=a(2265),r=a(6907);function i(){let[e,t]=(0,s.useState)(null),[a,i]=(0,s.useState)(null),[l,o]=(0,s.useState)(null),[d,c]=(0,s.useState)(null),[x,m]=(0,s.useState)(!0),[u,h]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/data/manifest.json?ts=".concat(Date.now()));if(!e.ok)throw Error("Failed to fetch manifest: ".concat(e.status));let a=await e.json();t(a);let n=await (0,r.gs)(a);i(n);let s=await (0,r.jy)();if(o(s),a.generated_at){let e=(0,r.f6)(a.generated_at);c(e)}m(!1)}catch(e){h(e instanceof Error?e.message:"Unknown error"),m(!1)}})()},[]);let g=t=>{var a;let s=null==e?void 0:null===(a=e.sources)||void 0===a?void 0:a[t],r="error"===s,i="no_data"===s,l="Sconosciuto",o="text-gray-500",d="❓";return r?(l="Errore",o="text-red-600",d="❌"):i?(l="Nessun dato",o="text-yellow-600",d="⚠️"):s&&"unknown"!==s&&(l="Attivo",o="text-green-600",d="✅"),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-green-500",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"camera"===t?"Camera dei Deputati":"Senato della Repubblica"}),(0,n.jsx)("p",{className:"text-2xl font-bold ".concat(o),children:l}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"camera"===t?"Assemblea":"Aula"})]}),(0,n.jsx)("div",{className:"text-4xl",children:d})]}),s&&"unknown"!==s&&"error"!==s&&"no_data"!==s&&(0,n.jsx)("div",{className:"mt-4 text-xs text-gray-500 break-all",children:(0,n.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:s})})]})};return x?(0,n.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-8",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"Caricamento metriche..."})]})}):u?(0,n.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-8",children:(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"text-red-600 text-xl mr-3",children:"❌"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-red-900",children:"Errore nel caricamento"}),(0,n.jsx)("p",{className:"text-red-800 mt-1",children:u})]})]})})}):(0,n.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-8",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Metriche Sistema"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Monitoraggio in tempo reale della pipeline di ingest e dello stato del registry"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(()=>{if(!a)return null;let e="Caricamento...",t="text-gray-500",s="\uD83D\uDCCA";return -1===a.count?(e="File disponibile (Parquet)",t="text-green-600",s="\uD83D\uDCCA"):0===a.count?(e="Nessun intervento",t="text-yellow-600",s="⚠️"):(e="".concat(a.count," interventi"),t="text-green-600",s="✅"),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Interventi Oggi"}),(0,n.jsx)("p",{className:"text-2xl font-bold ".concat(t),children:e}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["File: ",a.downloadUrl?(0,n.jsx)("a",{href:a.downloadUrl,download:a.filename,className:"text-blue-600 hover:text-blue-800 underline hover:no-underline",title:"Scarica ".concat(a.filename),children:a.filename}):a.filename]}),(0,n.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Ultimo aggiornamento: ",a.lastUpdate]})]}),(0,n.jsx)("div",{className:"text-4xl",children:s})]}),"parquet"===a.source&&(0,n.jsx)("div",{className:"mt-3 p-2 bg-blue-50 rounded text-xs text-blue-700",children:"\uD83D\uDCA1 File Parquet: i dati sono disponibili ma non visualizzabili nel browser"})]})})(),g("camera"),g("senato"),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-indigo-500",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Registry Identit\xe0"}),l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{className:"text-2xl font-bold text-indigo-600",children:[l.personsCount," persone"]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[l.partiesCount," partiti • ",l.inboxCount," in inbox"]}),(0,n.jsx)("div",{className:"mt-3 space-y-1",children:(0,n.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,n.jsx)("a",{href:l.downloadUrls.persons,download:"persons.jsonl",className:"text-blue-600 hover:text-blue-800 underline hover:no-underline mr-3",title:"Scarica persone",children:"\uD83D\uDCE5 persons.jsonl"}),(0,n.jsx)("a",{href:l.downloadUrls.parties,download:"party_registry.jsonl",className:"text-blue-600 hover:text-blue-800 underline hover:no-underline mr-3",title:"Scarica partiti",children:"\uD83D\uDCE5 party_registry.jsonl"}),(0,n.jsx)("a",{href:l.downloadUrls.inbox,download:"identities_inbox.jsonl",className:"text-blue-600 hover:text-blue-800 underline hover:no-underline",title:"Scarica inbox",children:"\uD83D\uDCE5 identities_inbox.jsonl"})]})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-2xl font-bold text-gray-400",children:"Caricamento..."}),(0,n.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Contando persone e partiti..."})]})]}),(0,n.jsx)("div",{className:"text-4xl",children:"\uD83D\uDC65"})]}),!l&&(0,n.jsx)("div",{className:"mt-4 text-xs text-gray-500",children:"Il registry viene aggiornato automaticamente ogni 5 minuti"})]}),(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-purple-500",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Versione Schema"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:(null==e?void 0:e.version)||"N/A"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Schema dati"})]}),(0,n.jsx)("div",{className:"text-4xl",children:"\uD83D\uDCCB"})]})}),(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-orange-500",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Ultimo Aggiornamento"}),(0,n.jsx)("p",{className:"text-lg font-bold text-orange-600",children:(null==e?void 0:e.generated_at)?new Date(e.generated_at).toLocaleString("it-IT"):"N/A"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Timestamp UTC"})]}),(0,n.jsx)("div",{className:"text-4xl",children:"\uD83D\uDD52"})]})})]}),(0,n.jsxs)("div",{className:"mt-8 bg-gray-50 rounded-lg p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informazioni Sistema"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium text-gray-700",children:"Architettura:"}),(0,n.jsx)("span",{className:"ml-2 text-gray-600",children:"GitHub-only (Pages + Actions)"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium text-gray-700",children:"Pipeline:"}),(0,n.jsx)("span",{className:"ml-2 text-gray-600",children:"Ingest ogni 5 minuti"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium text-gray-700",children:"Formato Dati:"}),(0,n.jsx)("span",{className:"ml-2 text-gray-600",children:"Parquet + JSON"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-medium text-gray-700",children:"Validazione:"}),(0,n.jsx)("span",{className:"ml-2 text-gray-600",children:"Schema JSON + CI/CD"})]})]})]}),(0,n.jsx)("div",{className:"mt-8 bg-blue-50 rounded-lg p-6 border-l-4 border-blue-400",children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("div",{className:"text-blue-600 text-xl mr-3",children:"ℹ️"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Dati Dinamici"}),(0,n.jsxs)("p",{className:"text-blue-800 text-sm",children:["Questa pagina mostra dati in tempo reale dalla pipeline di ingest. I file vengono aggiornati automaticamente ogni 5 minuti tramite GitHub Actions. Per i dettagli completi degli interventi, consulta i file Parquet in ",(0,n.jsx)("code",{className:"bg-blue-100 px-1 rounded",children:"public/data/"}),"."]}),(0,n.jsxs)("p",{className:"text-blue-800 text-sm mt-2",children:[(0,n.jsx)("strong",{children:"Prossimo aggiornamento:"})," ",d?"".concat(d.nextUpdate," (tra ").concat(d.timeUntil,")"):"Calcolo in corso..."]})]})]})})]})}},6907:function(e,t,a){"use strict";function n(e){let t=new Date,a=5*Math.ceil(t.getMinutes()/5),n=new Date(t);n.setMinutes(a,0,0),n<=t&&n.setMinutes(n.getMinutes()+5);let s=n.getTime()-t.getTime();return{nextUpdate:n.toLocaleString("it-IT"),timeUntil:"".concat(Math.ceil(s/6e4)," minuti")}}function s(e){try{return new Date(e).toLocaleString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(e){return"Data non valida"}}async function r(e){try{let t=await fetch(e);if(!t.ok)return 0;return(await t.text()).trim().split("\n").filter(e=>e.trim()).length}catch(e){return 0}}async function i(e){try{let t=await fetch(e);if(!t.ok)return 0;let n=await t.arrayBuffer(),s=new Uint8Array(n),r=(await a.e(337).then(a.bind(a,1337))).default,{readParquet:i}=await a.e(337).then(a.bind(a,1337)),{tableFromIPC:l}=await a.e(716).then(a.bind(a,4716));await r();let o=i(s);return l(o.intoIPCStream()).numRows}catch(e){return console.error("Error reading Parquet file:",e),0}}async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;try{let n=await fetch(e);if(!n.ok)return[];let s=await n.arrayBuffer(),r=new Uint8Array(s),i=(await a.e(337).then(a.bind(a,1337))).default,{readParquet:l}=await a.e(337).then(a.bind(a,1337)),{tableFromIPC:o}=await a.e(716).then(a.bind(a,4716));await i();let d=l(r),c=o(d.intoIPCStream()),x=[],m=Math.min(c.numRows,t);for(let e=0;e<m;e++){let t={};c.schema.fields.forEach(a=>{let n=c.getChild(a.name);n&&(t[a.name]=n.get(e))}),x.push(t)}return x}catch(e){return console.error("Error reading Parquet file:",e),[]}}async function o(e){try{let t=await fetch(e);if(!t.ok)return[];return(await t.text()).trim().split("\n").filter(e=>e.trim()).map(e=>JSON.parse(e))}catch(e){return[]}}async function d(){try{let[e,t,a]=await Promise.all([o("/data/persons.jsonl"),o("/data/party_registry.jsonl"),o("/data/identities_inbox.jsonl")]);return{personsCount:e.length,partiesCount:t.length,inboxCount:a.length,persons:e,parties:t,downloadUrls:{persons:"/data/persons.jsonl",parties:"/data/party_registry.jsonl",inbox:"/data/identities_inbox.jsonl"}}}catch(e){return{personsCount:0,partiesCount:0,inboxCount:0,persons:[],parties:[],downloadUrls:{persons:"/data/persons.jsonl",parties:"/data/party_registry.jsonl",inbox:"/data/identities_inbox.jsonl"}}}}async function c(e){var t;if(!(null===(t=e.current)||void 0===t?void 0:t.interventions))return{count:0,filename:"N/A",lastUpdate:"N/A",source:"none",downloadUrl:""};let a=e.current.interventions.split("/").pop()||"N/A",n=e.generated_at,l="/data/".concat(a);if(a.endsWith(".parquet"))try{return{count:await i("/data/".concat(a)),filename:a,lastUpdate:s(n),source:"parquet",downloadUrl:l}}catch(e){return{count:-1,filename:a,lastUpdate:s(n),source:"parquet",downloadUrl:l}}if(a.endsWith(".json")||a.endsWith(".jsonl"))try{return{count:await r("/data/".concat(a)),filename:a,lastUpdate:s(n),source:"json",downloadUrl:l}}catch(e){return{count:0,filename:a,lastUpdate:s(n),source:"json",downloadUrl:l}}return{count:0,filename:a,lastUpdate:s(n),source:"none",downloadUrl:""}}a.d(t,{f6:function(){return n},gs:function(){return c},jy:function(){return d},p6:function(){return s},qD:function(){return l}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=3042)}),_N_E=e.O()}]);